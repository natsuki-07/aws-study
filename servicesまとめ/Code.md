# CodeSeries
ソースコードをビルドしたり、ユニットテストを走らせたりといった開発プロセスの自動化を考える必要がある。継続的インテグレーション(CI)や継続的デリバリー(CD)と呼ばれる。そのための環境CI/CD環境をマネージドサービスとして提供しているのがCodeシリーズ  

## CodeCommit  
ソースコード管理のためのGitリポジトリサービスを提供するマネージドサービス。  
IAMユーザーを用いて権限管理を行う。例えばHTTPS方式でアクセスする場合は、コンソール上でコマンドを利用し、ローカル環境にあるIAMのクレデンシャル情報を用いてGitリポジトリに接続できる。  
  
またGitリポジトリに何らかのイベントが発生した際に、それをトリガーにSNSトピックを呼び出すことができる  
  
## CodeBuild  
その名のとおりソースコードのコンパイル/ビルド環境を提供するマネージドサービスです。  
CodeBuildはビルド環境を簡単に構築、運用できるマネージドサービス。マネジメントコンソールから数ステップでビルド環境を構築できる。  
  
CodeBuild上でユニットテストを実行することもでき、継続的な品質の担保にも貢献する。ビルド環境のランタイムとして、JavaやPHP、Python、Ruby、Node.jsなどを標準でサポートしているほか、個人で用意したDockerイメージを利用することもできる。  
  
ビルド対象のソースコード取得元として、CodeCommitはもちろんのこと外部プロバイダーとしてGitHubやBitbucketを選択することもできる。　

### ビルドの定義  
ビルド環境上で何をするかは、設定ファイルのbuildspec.ymlに定義する。この設定ファイルには、次の内容が含まれる。  

- ビルド環境のセットアップ情報  
- ビルド/ユニットテスト実行コマンド
- ビルド前後に実行したい処理  
- ビルド後の出力情報  

### 料金
ビルドにかかった時間単位の従量課金となる。
  
## CodeDeploy  
ビルド済みのモジュールのサーバーへのデプロイを自動化するサービス。デプロイのための作りこみを減らすことができ、よりビジネスに直結する機能の開発に集中できる。  
  
CodeDeployはEC2やLambda、そしてオンプレミスのサーバーに対してモジュールをデプロイできる。デプロイ時にどのモジュールをどこに配置するかといった設定はappspec.ymlに定義する。このファイルのhooksエリアにデプロイ前後の何かしらの処理を差し込むこともできる。  

|   デプロイ方式  |  具体的な動き  |
|  ----  |  ----  |
|  AllAtOnce  |  関連するサーバー全てに同時にデプロイを行う。  |
|  HalfAtTime  |  サーバー群の半分のリソースに対してデプロイを行う  |
|  OneAtATime  |  関連するサーバーを1つずつロードバランサーから切り離し、デプロイを行う  |  
  
  
デプロイの仕組みを自前で構築する場合、サーバー数が増減した際の対応が必要。特にAutoScalingを用いて動的にサーバー数が変わる構成を採用している場合はこの設計の難易度が上がる。CodeDeployでがAutoScalingグループをデプロイ対象として選択できるので、この問題を簡単に対処できる  

## CodePipeline  
CodePipelineを用いることでソースコードのPush、Pushを検知してビルド、ビルドが完了したことを検知してアーティファクトのデプロイという自動化されたパイプラインを作成することができる。また一部のプロセスをAWS以外のサービスに置き換えることも可能。  
  
リリース承認プロセスをパイプラインの途中に挟むことも可能。  
- 開発環境へのリリースまでは自動で行う  
- UAT環境へのリリース直前に承認者にメールを送信し、承認者が承認するまでパイプラインの処理を停止する。  
- 承認者が承認したタイミングでUAT環境へのリリースを行う